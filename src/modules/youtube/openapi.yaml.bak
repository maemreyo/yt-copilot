openapi: 3.0.0
info:
  title: YouTube Module API
  version: 1.0.0
  description: API endpoints for YouTube video analysis and metadata extraction
tags:
  - name: YouTube
    description: YouTube video analysis and metadata operations
paths:
  /v1/youtube/video/analyze:
    post:
      summary: Analyze YouTube video
      description: Extract metadata and information from a YouTube video URL
      tags:
        - YouTube
      operationId: analyzeYouTubeVideo
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalyzeVideoRequest'
            examples:
              basic:
                summary: Basic video analysis
                value:
                  videoUrl: "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
              withOptions:
                summary: Analysis with options
                value:
                  videoUrl: "https://youtu.be/dQw4w9WgXcQ"
                  options:
                    includeStatistics: true
                    includeTags: true
                    cacheResult: true
              shorts:
                summary: YouTube Shorts URL
                value:
                  videoUrl: "https://youtube.com/shorts/abcdefghijk"
      responses:
        '200':
          description: Video analyzed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeVideoResponse'
              examples:
                success:
                  value:
                    success: true
                    data:
                      video:
                        videoId: "dQw4w9WgXcQ"
                        title: "Rick Astley - Never Gonna Give You Up"
                        channelId: "UCuAXFkgsw1L7xaCfnd5JJOw"
                        channelName: "Rick Astley"
                        publishedAt: "2009-10-25T06:57:33Z"
                        durationSeconds: 212
                        thumbnailUrl: "https://i.ytimg.com/vi/dQw4w9WgXcQ/hqdefault.jpg"
                        viewCount: 1234567890
                        likeCount: 12345678
                      cached: false
                      processedAt: "2025-06-25T12:00:00Z"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidUrl:
                  value:
                    success: false
                    error:
                      code: "VALIDATION_ERROR"
                      message: "Invalid request parameters"
                      details: ["Invalid YouTube URL format"]
        '404':
          description: Video not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                notFound:
                  value:
                    success: false
                    error:
                      code: "VIDEO_NOT_FOUND"
                      message: "The requested video was not found"
        '429':
          description: Rate limit exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                rateLimited:
                  value:
                    success: false
                    error:
                      code: "RATE_LIMIT_EXCEEDED"
                      message: "Too many requests. Please try again later."
          headers:
            Retry-After:
              description: Number of seconds to wait before retrying
              schema:
                type: integer
                example: 60
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                quotaExceeded:
                  value:
                    success: false
                    error:
                      code: "API_QUOTA_EXCEEDED"
                      message: "YouTube API quota exceeded. Please try again later."
                internalError:
                  value:
                    success: false
                    error:
                      code: "INTERNAL_ERROR"
                      message: "An unexpected error occurred"
components:
  schemas:
    AnalyzeVideoRequest:
      type: object
      required:
        - videoUrl
      properties:
        videoUrl:
          type: string
          description: YouTube video URL or video ID
          examples:
            - "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
            - "https://youtu.be/dQw4w9WgXcQ"
            - "https://youtube.com/shorts/abcdefghijk"
            - "dQw4w9WgXcQ"
        options:
          type: object
          description: Optional analysis configuration
          properties:
            includeStatistics:
              type: boolean
              description: Include view count, like count, etc.
              default: false
            includeTags:
              type: boolean
              description: Include video tags
              default: false
            cacheResult:
              type: boolean
              description: Cache the result for faster subsequent requests
              default: true
    
    AnalyzeVideoResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            video:
              $ref: '#/components/schemas/VideoMetadata'
            cached:
              type: boolean
              description: Whether the result was retrieved from cache
            processedAt:
              type: string
              format: date-time
              description: Timestamp when the video was processed
        error:
          $ref: '#/components/schemas/Error'
    
    VideoMetadata:
      type: object
      required:
        - videoId
        - title
        - channelId
        - channelName
        - publishedAt
        - durationSeconds
      properties:
        videoId:
          type: string
          description: YouTube video ID (11 characters)
          pattern: '^[a-zA-Z0-9_-]{11}$'
        title:
          type: string
          description: Video title
        description:
          type: string
          description: Video description
        channelId:
          type: string
          description: YouTube channel ID
        channelName:
          type: string
          description: YouTube channel name
        publishedAt:
          type: string
          format: date-time
          description: Video publication date
        durationSeconds:
          type: integer
          description: Video duration in seconds
          minimum: 0
        thumbnailUrl:
          type: string
          format: uri
          description: URL of the video thumbnail
        viewCount:
          type: integer
          description: Number of views (only included if includeStatistics is true)
          minimum: 0
        likeCount:
          type: integer
          description: Number of likes (only included if includeStatistics is true)
          minimum: 0
        tags:
          type: array
          items:
            type: string
          description: Video tags (only included if includeTags is true)
    
    ExtractTranscriptRequest:
      type: object
      required:
        - videoId
      properties:
        videoId:
          type: string
          description: YouTube video ID (11 characters)
          pattern: '^[a-zA-Z0-9_-]{11}$'
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?$'
        options:
          type: object
          description: Optional transcript extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Prefer auto-generated captions if available
              default: false
            includeTimestamps:
              type: boolean
              description: Include timing information for each segment
              default: true
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    
    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            noToken:
              value:
                success: false
                error:
                  code: "AUTHENTICATION_ERROR"
                  message: "Authentication required"
    
    VideoNotFound:
      description: Video not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            notFound:
              value:
                success: false
                error:
                  code: "VIDEO_NOT_FOUND"
                  message: "Video not found"
    
    HistoryNotFound:
      description: History entry not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            notFound:
              value:
                success: false
                error:
                  code: "HISTORY_NOT_FOUND"
                  message: "Video not found in user history"
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication
    post:
      summary: Extract video transcript
      description: Extract transcript/captions from a YouTube video in the specified language
      tags:
        - YouTube
      operationId: extractTranscript
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExtractTranscriptRequest'
            examples:
              basic:
                summary: Extract transcript in default language
                value:
                  videoId: "dQw4w9WgXcQ"
              withLanguage:
                summary: Extract transcript in specific language
                value:
                  videoId: "dQw4w9WgXcQ"
                  language: "en"
              withOptions:
                summary: Extract with options
                value:
                  videoId: "dQw4w9WgXcQ"
                  language: "vi"
                  options:
                    preferAutoGenerated: false
                    includeTimestamps: true
      responses:
        '200':
          description: Transcript extracted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExtractTranscriptResponse'
              examples:
                success:
                  value:
                    success: true
                    data:
                      videoId: "dQw4w9WgXcQ"
                      language: "en"
                      languageName: "English"
                      isAutoGenerated: false
                      segments:
                        - start: 0.0
                          duration: 3.5
                          text: "We're no strangers to love"
                        - start: 3.5
                          duration: 3.2
                          text: "You know the rules and so do I"
                      totalDuration: 212
                      segmentCount: 42
                      characterCount: 1234
                      processedAt: "2025-06-25T12:00:00Z"
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidVideoId:
                  value:
                    success: false
                    error:
                      code: "VALIDATION_ERROR"
                      message: "Invalid request parameters"
                      details: ["Invalid video ID format"]
                invalidLanguage:
                  value:
                    success: false
                    error:
                      code: "VALIDATION_ERROR"
                      message: "Invalid request parameters"
                      details: ["language must be a valid ISO 639-1 code (e.g., en, vi)"]
        '404':
          description: Transcript not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                noTranscripts:
                  value:
                    success: false
                    error:
                      code: "NO_TRANSCRIPTS"
                      message: "No transcripts available for this video"
                videoNotFound:
                  value:
                    success: false
                    error:
                      code: "VIDEO_NOT_FOUND"
                      message: "Video not found or is private"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                fetchFailed:
                  value:
                    success: false
                    error:
                      code: "TRANSCRIPT_FETCH_FAILED"
                      message: "Failed to fetch transcript from YouTube"

  /v1/youtube/history:
    post:
      summary: Add video to history
      description: Add a video to the user's watch history or update existing entry
      tags:
        - YouTube
      operationId: addToHistory
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddToHistoryRequest'
            examples:
              basic:
                summary: Add video with progress
                value:
                  videoId: "dQw4w9WgXcQ"
                  progressSeconds: 150
              withPlaybackRate:
                summary: Add with custom playback rate
                value:
                  videoId: "dQw4w9WgXcQ"
                  progressSeconds: 150
                  playbackRate: 1.25
      responses:
        '201':
          description: Video added to history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '200':
          description: Existing history entry updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/VideoNotFound'
    
    get:
      summary: List user's video history
      description: Get the authenticated user's video watch history with filtering and pagination
      tags:
        - YouTube
      operationId: listHistory
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          description: Number of items to return (1-100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: offset
          in: query
          description: Number of items to skip
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: filter
          in: query
          description: Filter history by status
          schema:
            type: string
            enum: [all, bookmarked, completed, in-progress]
            default: all
        - name: sortBy
          in: query
          description: Sort order for results
          schema:
            type: string
            enum: [recent, alphabetical, duration]
            default: recent
      responses:
        '200':
          description: History retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListHistoryResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
  
  /v1/youtube/history/{videoId}:
    put:
      summary: Update history entry
      description: Update progress, bookmark status, or notes for a video in history
      tags:
        - YouTube
      operationId: updateHistory
      security:
        - bearerAuth: []
      parameters:
        - name: videoId
          in: path
          required: true
          description: YouTube video ID
          schema:
            type: string
            pattern: '^[a-zA-Z0-9_-]{11}
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication


# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    AddToHistoryRequest:
      type: object
      required:
        - videoId
      properties:
        videoId:
          type: string
          description: YouTube video ID
          pattern: '^[a-zA-Z0-9_-]{11}
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHistoryRequest'
            examples:
              updateProgress:
                summary: Update watch progress
                value:
                  progressSeconds: 200
              bookmark:
                summary: Bookmark video with notes
                value:
                  isBookmarked: true
                  notes: "Great explanation at 3:45"
                  tags: ["educational", "favorite"]
      responses:
        '200':
          description: History updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/HistoryNotFound'
    
    delete:
      summary: Remove video from history
      description: Delete a video from the user's watch history
      tags:
        - YouTube
      operationId: deleteFromHistory
      security:
        - bearerAuth: []
      parameters:
        - name: videoId
          in: path
          required: true
          description: YouTube video ID
          schema:
            type: string
            pattern: '^[a-zA-Z0-9_-]{11}
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
      responses:
        '200':
          description: Video removed from history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/HistoryNotFound'
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
        progressSeconds:
          type: number
          description: Current playback position in seconds
          minimum: 0
          default: 0
        playbackRate:
          type: number
          description: Playback speed (0.25 to 2.0)
          minimum: 0.25
          maximum: 2.0
          default: 1.0
    
    UpdateHistoryRequest:
      type: object
      properties:
        progressSeconds:
          type: number
          description: Current playback position in seconds
          minimum: 0
        completed:
          type: boolean
          description: Whether the video has been completed
        playbackRate:
          type: number
          description: Playback speed (0.25 to 2.0)
          minimum: 0.25
          maximum: 2.0
        isBookmarked:
          type: boolean
          description: Whether to bookmark this video
        notes:
          type: string
          description: Personal notes about the video
          maxLength: 5000
        tags:
          type: array
          description: Tags for categorizing the video
          maxItems: 20
          items:
            type: string
            maxLength: 50
    
    VideoHistoryEntry:
      type: object
      properties:
        historyId:
          type: string
          format: uuid
        videoId:
          type: string
          pattern: '^[a-zA-Z0-9_-]{11}
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHistoryRequest'
            examples:
              updateProgress:
                summary: Update watch progress
                value:
                  progressSeconds: 200
              bookmark:
                summary: Bookmark video with notes
                value:
                  isBookmarked: true
                  notes: "Great explanation at 3:45"
                  tags: ["educational", "favorite"]
      responses:
        '200':
          description: History updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/HistoryNotFound'
    
    delete:
      summary: Remove video from history
      description: Delete a video from the user's watch history
      tags:
        - YouTube
      operationId: deleteFromHistory
      security:
        - bearerAuth: []
      parameters:
        - name: videoId
          in: path
          required: true
          description: YouTube video ID
          schema:
            type: string
            pattern: '^[a-zA-Z0-9_-]{11}
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
      responses:
        '200':
          description: Video removed from history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/HistoryNotFound'

# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
        videoTitle:
          type: string
        channelName:
          type: string
        thumbnailUrl:
          type: string
          format: uri
        durationSeconds:
          type: integer
        progressSeconds:
          type: integer
        completed:
          type: boolean
        isBookmarked:
          type: boolean
        lastWatchedAt:
          type: string
          format: date-time
        watchCount:
          type: integer
          minimum: 1
        playbackRate:
          type: number
        notes:
          type: string
        tags:
          type: array
          items:
            type: string
    
    ListHistoryResponse:
      type: object
      required:
        - success
        - data
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            history:
              type: array
              items:
                $ref: '#/components/schemas/VideoHistoryEntry'
            total:
              type: integer
              description: Total number of items
            hasMore:
              type: boolean
              description: Whether there are more items to load
    
    HistoryOperationResponse:
      type: object
      required:
        - success
        - data
      properties:
        success:
          type: boolean
        data:
          type: object
          properties:
            message:
              type: string
            historyId:
              type: string
              format: uuid
            videoId:
              type: string
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHistoryRequest'
            examples:
              updateProgress:
                summary: Update watch progress
                value:
                  progressSeconds: 200
              bookmark:
                summary: Bookmark video with notes
                value:
                  isBookmarked: true
                  notes: "Great explanation at 3:45"
                  tags: ["educational", "favorite"]
      responses:
        '200':
          description: History updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/HistoryNotFound'
    
    delete:
      summary: Remove video from history
      description: Delete a video from the user's watch history
      tags:
        - YouTube
      operationId: deleteFromHistory
      security:
        - bearerAuth: []
      parameters:
        - name: videoId
          in: path
          required: true
          description: YouTube video ID
          schema:
            type: string
            pattern: '^[a-zA-Z0-9_-]{11}
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
      responses:
        '200':
          description: Video removed from history
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryOperationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/HistoryNotFound'

# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          example: "dQw4w9WgXcQ"
        language:
          type: string
          description: ISO 639-1 language code
          pattern: '^[a-z]{2}(-[A-Z]{2})?
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history
          default: "en"
          examples:
            - "en"
            - "vi"
            - "es"
            - "fr"
        options:
          type: object
          description: Optional extraction configuration
          properties:
            preferAutoGenerated:
              type: boolean
              description: Whether to prefer auto-generated captions
              default: false
            includeTimestamps:
              type: boolean
              description: Whether to include timestamp information
              default: true
    
    ExtractTranscriptResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the request was successful
        data:
          type: object
          properties:
            videoId:
              type: string
              description: YouTube video ID
            language:
              type: string
              description: Language code of the transcript
            languageName:
              type: string
              description: Human-readable language name
            isAutoGenerated:
              type: boolean
              description: Whether the transcript was auto-generated
            segments:
              type: array
              description: Transcript segments with timing
              items:
                $ref: '#/components/schemas/TranscriptSegment'
            totalDuration:
              type: number
              description: Total duration of the video in seconds
            segmentCount:
              type: integer
              description: Number of transcript segments
            characterCount:
              type: integer
              description: Total character count of all segments
            processedAt:
              type: string
              format: date-time
              description: When the transcript was processed
        error:
          $ref: '#/components/schemas/Error'
    
    TranscriptSegment:
      type: object
      required:
        - start
        - duration
        - text
      properties:
        start:
          type: number
          description: Start time in seconds
          example: 0.0
        duration:
          type: number
          description: Duration in seconds
          example: 3.5
        text:
          type: string
          description: Transcript text for this segment
          example: "We're no strangers to love"
    
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          enum:
            - VALIDATION_ERROR
            - VIDEO_NOT_FOUND
            - VIDEO_PRIVATE
            - VIDEO_DELETED
            - API_QUOTA_EXCEEDED
            - RATE_LIMIT_EXCEEDED
            - CONFIGURATION_ERROR
            - INTERNAL_ERROR
        message:
          type: string
          description: Human-readable error message
        details:
          type: array
          items:
            type: string
          description: Additional error details
    
    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/Error'
  
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authenticated users
    
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for machine-to-machine authentication



# Future endpoints to be implemented
# /v1/youtube/history - User video history management
# /v1/youtube/history/{videoId} - Update/delete specific video from history